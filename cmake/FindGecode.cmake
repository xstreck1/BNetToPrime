#Works under the assumption than when gecode is installed at least the kernel component exists

MESSAGE("GECODE_DIR " ${GECODE_DIR})

if(UNIX)
	MESSAGE(STATUS "UNIX TRUE")
	set(GECODE_LIBDIR ${GECODE_DIR})
	set(GECODE_LIBDIR_D ${GECODE_DIR})
	set(GECODE_INCLUDEDIR ${GECODE_DIR})
else()
	set(GECODE_LIBDIR ${GECODE_DIR}/Release)
	set(GECODE_LIBDIR_D ${GECODE_DIR}/Debug)
	set(GECODE_INCLUDEDIR ${GECODE_DIR})
endif()

# Look for the header file
find_path(GECODE_INCLUDE_DIR PATHS ${GECODE_INCLUDEDIR} NAMES gecode/kernel.hh)
find_file(GECODE_CONFIG PATHS ${GECODE_INCLUDEDIR} NAMES gecode/support/config.hpp)

# Look for the library
find_library(GECODE_LIBRARY PATHS ${GECODE_LIBDIR} NAMES gecodekernel)
find_library(GECODE_SUPPORT_LIBRARY PATHS ${GECODE_LIBDIR} NAMES gecodesupport)

if(GECODE_CONFIG)
	file(STRINGS ${GECODE_CONFIG} GECODE_LINE_VERSION REGEX "^#define GECODE_VERSION .*")
	string(REGEX MATCH "[0-9].[0-9].[0-9]" GECODE_VERSION ${GECODE_LINE_VERSION})
endif()


MESSAGE("GECODE INCLUDE " ${GECODE_INCLUDE_DIR})
MESSAGE("GECODE LIBRARY " ${GECODE_LIBRARY})
MESSAGE("GECODE SUPPORT_LIBRARY " ${GECODE_SUPPORT_LIBRARY})
if(GECODE_INCLUDE_DIR AND GECODE_LIBRARY AND GECODE_SUPPORT_LIBRARY)
	set(GECODE_FOUND Yes)
endif()

if(GECODE_FOUND)

	set(Gecode_INCLUDE_DIRS ${GECODE_INCLUDE_DIR})

	set(Gecode_LIBRARIES optimized ${GECODE_LIBRARY} optimized ${GECODE_SUPPORT_LIBRARY})
	find_library(GECODE_DRIVER_LIBRARY PATHS ${GECODE_LIBDIR} NAMES gecodedriver)
	if(GECODE_DRIVER_LIBRARY)
		list(APPEND Gecode_LIBRARIES optimized)
		list(APPEND Gecode_LIBRARIES ${GECODE_DRIVER_LIBRARY})
	endif()
	find_library(GECODE_FZ_LIBRARY PATHS ${GECODE_LIBDIR} NAMES gecodeflatzinc)
	if(GECODE_FZ_LIBRARY)
		list(APPEND Gecode_LIBRARIES optimized)
		list(APPEND Gecode_LIBRARIES ${GECODE_FZ_LIBRARY})
	endif()
	find_library(GECODE_GIST_LIBRARY PATHS ${GECODE_LIBDIR} NAMES gecodegist)
	if(GECODE_GIST_LIBRARY)
		list(APPEND Gecode_LIBRARIES optimized)
		list(APPEND Gecode_LIBRARIES ${GECODE_GIST_LIBRARY})
	endif()
	find_library(GECODE_GRAPH_LIBRARY PATHS ${GECODE_LIBDIR} NAMES gecodegraph)
	if(GECODE_GRAPH_LIBRARY)
		list(APPEND Gecode_LIBRARIES optimized)
		list(APPEND Gecode_LIBRARIES ${GECODE_GRAPH_LIBRARY})
	endif()
	find_library(GECODE_INT_LIBRARY PATHS ${GECODE_LIBDIR} NAMES gecodeint)
	if(GECODE_INT_LIBRARY)
		list(APPEND Gecode_LIBRARIES optimized)
		list(APPEND Gecode_LIBRARIES ${GECODE_INT_LIBRARY})
	endif()
	find_library(GECODE_FLOAT_LIBRARY PATHS ${GECODE_LIBDIR} NAMES gecodefloat)
	if(GECODE_FLOAT_LIBRARY)
		list(APPEND Gecode_LIBRARIES optimized)
		list(APPEND Gecode_LIBRARIES ${GECODE_FLOAT_LIBRARY})
	endif()
	find_library(GECODE_MM_LIBRARY PATHS ${GECODE_LIBDIR} NAMES gecodeminimodel)
	if(GECODE_MM_LIBRARY)
		list(APPEND Gecode_LIBRARIES optimized)
		list(APPEND Gecode_LIBRARIES ${GECODE_MM_LIBRARY})
	endif()
	find_library(GECODE_SCHEDULING_LIBRARY PATHS ${GECODE_LIBDIR} NAMES gecodescheduling)
	if(GECODE_SCHEDULING_LIBRARY)
		list(APPEND Gecode_LIBRARIES optimized)
		list(APPEND Gecode_LIBRARIES ${GECODE_SCHEDULING_LIBRARY})
	endif()
	find_library(GECODE_SEARCH_LIBRARY PATHS ${GECODE_LIBDIR} NAMES gecodesearch)
	if(GECODE_SEARCH_LIBRARY)
		list(APPEND Gecode_LIBRARIES optimized)
		list(APPEND Gecode_LIBRARIES ${GECODE_SEARCH_LIBRARY})
	endif()
	find_library(GECODE_SET_LIBRARY PATHS ${GECODE_LIBDIR} NAMES gecodeset)
	if(GECODE_SET_LIBRARY)
		list(APPEND Gecode_LIBRARIES optimized)
		list(APPEND Gecode_LIBRARIES ${GECODE_SET_LIBRARY})
	endif()

	find_library(GECODE_LIBRARY_D PATHS ${GECODE_LIBDIR_D} NAMES gecodekernel)
	find_library(GECODE_SUPPORT_LIBRARY_D PATHS ${GECODE_LIBDIR_D} NAMES gecodesupport)
	
	set(Gecode_LIBRARIES_D debug ${GECODE_LIBRARY_D} debug ${GECODE_SUPPORT_LIBRARY_D})
	
	find_library(GECODE_DRIVER_LIBRARY_D PATHS ${GECODE_LIBDIR_D} NAMES gecodedriver)
	if(GECODE_DRIVER_LIBRARY_D)
		list(APPEND Gecode_LIBRARIES_D debug)
		list(APPEND Gecode_LIBRARIES_D ${GECODE_DRIVER_LIBRARY_D})
	endif()
	find_library(GECODE_FZ_LIBRARY_D PATHS ${GECODE_LIBDIR_D} NAMES gecodeflatzinc)
	if(GECODE_FZ_LIBRARY_D)
		list(APPEND Gecode_LIBRARIES_D debug)
		list(APPEND Gecode_LIBRARIES_D ${GECODE_FZ_LIBRARY_D})
	endif()
	find_library(GECODE_GIST_LIBRARY_D PATHS ${GECODE_LIBDIR_D} NAMES gecodegist)
	if(GECODE_GIST_LIBRARY_D)
		list(APPEND Gecode_LIBRARIES_D debug)
		list(APPEND Gecode_LIBRARIES_D ${GECODE_GIST_LIBRARY_D})
	endif()
	find_library(GECODE_GRAPH_LIBRARY_D PATHS ${GECODE_LIBDIR_D} NAMES gecodegraph)
	if(GECODE_GRAPH_LIBRARY_D)
		list(APPEND Gecode_LIBRARIES_D debug)
		list(APPEND Gecode_LIBRARIES_D ${GECODE_GRAPH_LIBRARY_D})
	endif()
	find_library(GECODE_INT_LIBRARY_D PATHS ${GECODE_LIBDIR_D} NAMES gecodeint)
	if(GECODE_INT_LIBRARY_D)
		list(APPEND Gecode_LIBRARIES_D debug)
		list(APPEND Gecode_LIBRARIES_D ${GECODE_INT_LIBRARY_D})
	endif()
	find_library(GECODE_FLOAT_LIBRARY_D PATHS ${GECODE_LIBDIR_D} NAMES gecodefloat)
	if(GECODE_FLOAT_LIBRARY_D)
		list(APPEND Gecode_LIBRARIES_D debug)
		list(APPEND Gecode_LIBRARIES_D ${GECODE_FLOAT_LIBRARY_D})
	endif()
	find_library(GECODE_MM_LIBRARY_D PATHS ${GECODE_LIBDIR_D} NAMES gecodeminimodel)
	if(GECODE_MM_LIBRARY_D)
		list(APPEND Gecode_LIBRARIES_D debug)
		list(APPEND Gecode_LIBRARIES_D ${GECODE_MM_LIBRARY_D})
	endif()
	find_library(GECODE_SCHEDULING_LIBRARY_D PATHS ${GECODE_LIBDIR_D} NAMES gecodescheduling)
	if(GECODE_SCHEDULING_LIBRARY_D)
		list(APPEND Gecode_LIBRARIES_D debug)
		list(APPEND Gecode_LIBRARIES_D ${GECODE_SCHEDULING_LIBRARY_D})
	endif()
	find_library(GECODE_SEARCH_LIBRARY_D PATHS ${GECODE_LIBDIR_D} NAMES gecodesearch)
	if(GECODE_SEARCH_LIBRARY_D)
		list(APPEND Gecode_LIBRARIES_D debug)
		list(APPEND Gecode_LIBRARIES_D ${GECODE_SEARCH_LIBRARY_D})
	endif()
	find_library(GECODE_SET_LIBRARY_D PATHS ${GECODE_LIBDIR_D} NAMES gecodeset)
	if(GECODE_SET_LIBRARY_D)
		list(APPEND Gecode_LIBRARIES_D debug)
		list(APPEND Gecode_LIBRARIES_D ${GECODE_SET_LIBRARY_D})
	endif()
else()
	set(Gecode_LIBRARIES_D ${Gecode_LIBRARIES})
endif()


